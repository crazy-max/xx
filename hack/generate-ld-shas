#!/usr/bin/env bash
set -e

: "${DIST=./bin/prebuilt-ld}"

cat >./base/xx-ld-shas <<EOL
#!/usr/bin/env sh

# DO NOT EDIT! Generated by ".github/workflows/prebuilt-ld.yml"

LD_SHAS=\$(
  cat <<'EOT'
EOL

for file in "${DIST}"/*-ld-*; do
  echo "$(basename -- "${file%.tar.gz}") $(sha1sum "$file" | cut -d' ' -f1)" >>./base/xx-ld-shas
done

cat >>./base/xx-ld-shas <<EOL
EOT
)
export LD_SHAS

LD64_SHAS=\$(
  cat <<'EOT'
EOL

for file in "${DIST}"/ld64-*; do
  echo "$(basename -- "${file%.tar.gz}") $(sha1sum "$file" | cut -d' ' -f1)" >>./base/xx-ld-shas
done

cat >>./base/xx-ld-shas <<EOL
EOT
)
export LD64_SHAS
EOL

cat ./base/xx-ld-shas
